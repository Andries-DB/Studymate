import{o as f,f as y,b as n,t as d,X as x,a as i,w as r,F as j,s as c,d as h}from"./app-ba05baeb.js";import{_ as k}from"./PrimaryButton-c92b1233.js";import{_ as $}from"./UserLayout-6eef3dd9.js";import{_ as g}from"./_plugin-vue_export-helper-c27b6911.js";import"./Modal-48d1d19f.js";import"./TextInput-88a47543.js";import"./ErrorHandling-f39449d2.js";const L={},B={id:"cameraPlaceholder",class:"video-player bg-white text-black hover:bg-white transform transition hover:-translate-y-1 border-2 border-dashed rounded-xl p-4 flex justify-center text-center items-center gap-3 hover:cursor-pointer"},I={class:"flex items-center justify-center h-full text-center"};function C(e,t){return f(),y("div",B,[n("h2",I,d(e.$t("Widgets.JoinStudy")),1)])}const E=g(L,[["render",C]]);const M="a7b0b358dfbe4f40b99648a9d699d613",v=window.location.pathname.split("/").pop();let a,s=[],p={};const S={props:{studyroomInformation:Object,owner:Object,client:Object},methods:{async joinstream(){try{axios.post("/agora/token",{channelName:v}).then(e=>{this.joinRoomInit(e.data,v),document.getElementById("cameraPlaceholder").classList.add("hidden"),document.getElementById("join-btn").classList.add("hidden"),document.getElementById("leave-btn").classList.remove("hidden"),document.getElementById("screen-btn").classList.remove("hidden")})}catch(e){console.log(e)}},async joinRoomInit(e,t){const o=this.client.username;a=AgoraRTC.createClient({mode:"rtc",codec:"vp8"}),await a.join(M,t,e,o),a.on("user-published",this.handleUserPublished),a.on("user-left",this.handleUserLeft),this.joinStream(o,this.client.username)},async joinStream(e,t){s=await AgoraRTC.createMicrophoneAndCameraTracks({},{encoderConfig:{width:{min:640,ideal:1920,max:1920},height:{min:480,ideal:1080,max:1080},frameRate:{min:15,ideal:30,max:30},bitrate:{min:500,ideal:1e3,max:1e3}}});let o=`
              <div id="user-container-${e}" class="video__container your-container">
                <div id="user-${e}" class="video-player bg-black"></div>
                <h4 class="user-name flex justify-center mt-2">Jij (${t})</h4>
              </div>
              `;document.getElementById("yourCamera").insertAdjacentHTML("beforeend",o),s[1].play(`user-${e}`),await a.publish([s[0],s[1]])},async handleUserPublished(e,t){p[e.uid]=e,await a.subscribe(e,t);let o=document.getElementById(`user-container-${e.uid}`);o===null&&(o=`
                  <div id="user-container-${e.uid}" class="video__container">
                    <div id="user-${e.uid}" class="video-player bg-black"></div>
                    <h4 class="user-name flex justify-center mt-2">${e.uid}</h4>
                  </div>
                  `,document.getElementById("videos").insertAdjacentHTML("beforeend",o)),t==="video"&&e.videoTrack.play(`user-${e.uid}`)},async handleUserLeft(e){document.getElementById(`user-container-${e.uid}`).remove(),delete p[e.uid]},async leaveStream(){s[0].close(),s[1].close(),await a.leave(),document.getElementById("cameraPlaceholder").classList.remove("hidden"),document.getElementById("join-btn").classList.remove("hidden"),document.getElementById("leave-btn").classList.add("hidden"),document.getElementById("screen-btn").classList.add("hidden"),document.getElementById("videos").innerHTML="",document.getElementById("yourCamera").innerHTML="",document.getElementById("nothingtoshow").classList.remove("hidden")},async toggleCamera(e){let t=document.getElementById("screen-btn");s[1].muted?(await s[1].setMuted(!1),t.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M12 18.75H4.5a2.25 2.25 0 01-2.25-2.25V9m12.841 9.091L16.5 19.5m-1.409-1.409c.407-.407.659-.97.659-1.591v-9a2.25 2.25 0 00-2.25-2.25h-9c-.621 0-1.184.252-1.591.659m12.182 12.182L2.909 5.909M1.5 4.5l1.409 1.409" />
                    </svg>`,t.classList.add("active")):(await s[1].setMuted(!0),t.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                      <path stroke-linecap="round" d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z" />
                    </svg>`,t.classList.remove("active"))}},components:{UserLayout:$,Head:x,PrimaryButton:k,JoinStudy:E}},H={class:"flex flex-col gap-10 lg:p-7 lg:ml-8"},T={class:"flex justify-between"},P={class:"lg:p-0 p-7"},U={class:"font-bold text-3xl"},A={class:"grid grid-cols-12 grid-rows-2 h-full w-full"},R={class:"row-span-5 col-span-12 md:col-span-3"},J={class:"flex items-center justify-center lg:block"},V=n("div",{id:"yourCamera",class:"lg:fixed"},null,-1),D=n("div",{class:"row-span-5 col-span-12 md:col-span-9 flex justify-center lg:block mb-36"},[n("div",{id:"videos",class:"flex h-full flex-wrap justify-center gap-5"})],-1),N={class:"w-full h-20 fixed bg-stone-100 bottom-0 flex justify-center gap-5 items-center"},O={id:"screen-btn-div"},F=n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-6 h-6"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M12 18.75H4.5a2.25 2.25 0 01-2.25-2.25V9m12.841 9.091L16.5 19.5m-1.409-1.409c.407-.407.659-.97.659-1.591v-9a2.25 2.25 0 00-2.25-2.25h-9c-.621 0-1.184.252-1.591.659m12.182 12.182L2.909 5.909M1.5 4.5l1.409 1.409"})],-1);function z(e,t,o,W,X,l){const _=c("Head"),b=c("JoinStudy"),w=c("UserLayout"),m=c("PrimaryButton");return f(),y(j,null,[i(_,{title:e.$page.props.studyroomInformation.name},null,8,["title"]),i(w,null,{default:r(()=>[n("div",H,[n("div",T,[n("div",P,[n("h1",U,d(e.$page.props.studyroomInformation.name),1),n("h2",null,d(e.$page.props.studyroomInformation.private?`Een kamer van ${e.$page.props.owner.user.username}`:"Een openbare studeerkamer"),1)])]),n("div",A,[n("div",R,[n("div",J,[i(b,{onClick:t[0]||(t[0]=u=>l.joinstream())}),V])]),D])])]),_:1}),n("div",N,[n("div",null,[i(m,{id:"join-btn",onClick:t[1]||(t[1]=u=>l.joinstream())},{default:r(()=>[h(d(e.$t("Study.JoinStudyRoom")),1)]),_:1})]),n("div",null,[i(m,{id:"leave-btn",class:"hidden",onClick:t[2]||(t[2]=u=>l.leaveStream())},{default:r(()=>[h(d(e.$t("Study.LeaveStudyRoom")),1)]),_:1})]),n("div",O,[i(m,{id:"screen-btn",class:"hidden",onClick:t[3]||(t[3]=u=>l.toggleCamera(e.event))},{default:r(()=>[F]),_:1})])])],64)}const te=g(S,[["render",z]]);export{te as default};
